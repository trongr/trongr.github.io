<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<title>Node.js</title>
<link rel='stylesheet' href='../css/global.css'>
<link rel='stylesheet' href='../css/obsidian.min.css'>
<script src='../js/highlight.min.js'></script>
<!-- this config must be before MathJax.js: -->
<script src='../js/mathjax.config.js'></script>
<script src='../js/MathJax/MathJax.js'></script>
<!-- <script src='https: //cdn.mathjax.org/mathjax/latest/MathJax.js'></script> -->
<script src='../js/jquery-3.1.0.min.js'></script>
<script src='../js/smartquotes.js'></script>
<script src='../js/global.js'></script>
</head>
<body>
<div id='content'>
<a href='../index.html'>HOME</a>
<h1>Node.js</h1>
<script src='../js/toc.js'></script>
<div id='toc'></div>

<h1>Request</h1>

<pre><code>request.post({
    url: "http://IP:PORT/asdf?q=asdf",
    headers: {
        "Client-ID": "1234",
    },
    body: {
        asdf: 123
    },
    json: true,
    timeout: 60 * 1000 // ms
}, function(er, res, body){
    if (er) console.log("ERROR", er, body)
    else assert(body.books.length > 0)
})

request({
    method: "GET",
    url: "http://localhost:5000/RandomFaces",
    qs: {
        outputDir: "out",
        imgFilename: "RandomFaces.jpg",
        txtFilename: "RandomFaces.txt"
    },
    json: true
}, function (er, res, body) {
    ...
})
</code></pre>

<h1>Child process</h1>

<p>
    <code>cwd</code> is the directory you run node from, so e.g. <code>cwd:
    ".."</code> is the directory above that.
</p>

<pre><code>const { spawn } = require('child_process')
const child = spawn("bash",
    ["RunRandomFaces.sh", dir, imgFilename, txtFilename],
    { cwd: ".." })
child.on('error', (er) => console.error(er))
child.stdout.on('data', (data) => console.log(data.toString()))
child.stderr.on('data', (data) => console.error(data.toString()))
child.on('exit', (code, signal) => assert(code == 0))
</code></pre>

</div>
</body>
</html>